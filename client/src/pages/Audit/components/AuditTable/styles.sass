@use "@/common/styles/colors"

$mobile: 768px
$tablet: 1024px

.audit-table-container
  background-color: colors.$lighter-background
  border: 1px solid colors.$dark-gray
  border-radius: 0.75rem
  padding: 0.375rem
  box-shadow: 0 12px 48px rgba(0, 0, 0, 0.5), 0 4px 16px rgba(0, 0, 0, 0.3)
  overflow: hidden
  min-height: 400px
  display: flex
  flex-direction: column
  position: relative
  min-width: 0

  @media (max-width: $mobile)
    min-height: 300px
    padding: 0.25rem

  .loading-overlay
    position: absolute
    inset: 0
    background-color: rgba(0, 0, 0, 0.5)
    display: flex
    flex-direction: column
    align-items: center
    justify-content: center
    gap: 1rem
    color: colors.$white
    z-index: 10

    svg
      width: 2rem
      height: 2rem

  .no-logs
    display: flex
    flex-direction: column
    align-items: center
    justify-content: center
    padding: 3rem
    color: colors.$subtext
    text-align: center
    flex: 1

    @media (max-width: $mobile)
      padding: 2rem 1rem

    svg
      width: 3rem
      height: 3rem
      margin-bottom: 1rem
      opacity: 0.7

      @media (max-width: $mobile)
        width: 2.5rem
        height: 2.5rem

    h3
      margin: 0 0 0.5rem 0
      font-size: 0.95rem
      font-weight: 500

      @media (max-width: $mobile)
        font-size: 0.9rem

    p
      margin: 0
      font-size: 0.85rem

      @media (max-width: $mobile)
        font-size: 0.8rem

.audit-table
  flex: 1
  overflow: hidden
  display: flex
  flex-direction: column
  width: 100%
  min-width: 0

  .table-header
    display: grid
    grid-template-columns: minmax(100px, 1.5fr) minmax(120px, 2fr) minmax(100px, 1.5fr) minmax(80px, 1fr) minmax(80px, 1fr) 50px
    gap: 0.75rem
    padding: 0.625rem 0.75rem
    background-color: colors.$dark-gray
    border-bottom: 1px solid colors.$dark-gray
    border-radius: 0.5rem 0.5rem 0 0
    font-weight: 500
    font-size: 0.85rem
    color: colors.$subtext

    @media (max-width: $tablet)
      grid-template-columns: minmax(90px, 1.5fr) minmax(100px, 2fr) minmax(80px, 1fr) 40px
      gap: 0.5rem
      padding: 0.5rem 0.625rem
      font-size: 0.8rem

      .header-cell:nth-child(4),
      .header-cell:nth-child(5)
        display: none

    @media (max-width: $mobile)
      display: none

    .header-cell
      display: flex
      align-items: center
      gap: 0.5rem
      min-width: 0
      overflow: hidden

      svg
        width: 1.125rem
        height: 1.125rem
        opacity: 0.9
        flex-shrink: 0

      span
        overflow: hidden
        text-overflow: ellipsis
        white-space: nowrap

  .table-body
    flex: 1
    overflow-y: auto
    overflow-x: hidden
    scrollbar-width: thin
    scrollbar-color: colors.$gray colors.$lighter-background

    &::-webkit-scrollbar
      width: 6px

    &::-webkit-scrollbar-track
      background: transparent

    &::-webkit-scrollbar-thumb
      background-color: colors.$gray
      border-radius: 10px

    .table-row
      border-bottom: 1px solid colors.$dark-gray
      margin-bottom: 0.25rem

      @media (max-width: $mobile)
        &:active .row-main
          background-color: colors.$gray

      .row-main
        display: grid
        grid-template-columns: minmax(100px, 1.5fr) minmax(120px, 2fr) minmax(100px, 1.5fr) minmax(80px, 1fr) minmax(80px, 1fr) 50px
        gap: 0.75rem
        padding: 0.625rem 0.75rem
        cursor: pointer
        transition: background-color 0.1s ease
        border-radius: 0.5rem
        user-select: none

        @media (max-width: $tablet)
          grid-template-columns: minmax(90px, 1.5fr) minmax(100px, 2fr) minmax(80px, 1fr) 40px
          gap: 0.5rem
          padding: 0.5rem 0.625rem

          .cell:nth-child(4),
          .cell:nth-child(5)
            display: none

        @media (max-width: $mobile)
          display: flex
          flex-direction: column
          gap: 0.5rem
          padding: 0.75rem 0.625rem

          .cell
            display: flex !important
            width: 100%

        &:hover
          background-color: colors.$gray

        &:focus-visible
          outline: 2px solid colors.$primary
          outline-offset: -2px

        .cell
          display: flex
          align-items: center
          font-size: 0.9rem
          min-width: 0
          overflow: hidden

          @media (max-width: $tablet)
            font-size: 0.85rem

          @media (max-width: $mobile)
            flex-direction: row
            align-items: center
            gap: 0.5rem
            font-size: 0.85rem

            &::before
              content: attr(data-label)
              font-size: 0.7rem
              color: colors.$subtext
              text-transform: uppercase
              font-weight: 600
              min-width: 80px
              flex-shrink: 0

          &.timestamp
            .timestamp-content
              display: flex
              flex-direction: column
              gap: 0.25rem
              min-width: 0

              .date
                color: colors.$white
                font-weight: 500
                white-space: nowrap
                overflow: hidden
                text-overflow: ellipsis

              .time
                color: colors.$subtext
                font-size: 0.8rem
                font-family: monospace
                white-space: nowrap

          &.action
            .action-content
              display: flex
              align-items: center
              gap: 0.5rem
              min-width: 0

              @media (max-width: $mobile)
                flex-direction: row
                align-items: center
                gap: 0.5rem

              svg
                width: 1.125rem
                height: 1.125rem
                color: colors.$subtext
                opacity: 0.9
                flex-shrink: 0

              .action-badge
                padding: 0.25rem 0.625rem
                border-radius: 0.5rem
                font-size: 0.75rem
                font-weight: 500
                text-transform: uppercase
                white-space: nowrap

                @media (max-width: $mobile)
                  font-size: 0.7rem
                  padding: 0.2rem 0.5rem

                &.green
                  background-color: rgba(34, 197, 94, 0.2)
                  color: #22c55e

                &.blue
                  background-color: rgba(59, 130, 246, 0.2)
                  color: #3b82f6

                &.orange
                  background-color: rgba(249, 115, 22, 0.2)
                  color: #f97316

                &.red
                  background-color: rgba(239, 68, 68, 0.2)
                  color: #ef4444

                &.purple
                  background-color: rgba(168, 85, 247, 0.2)
                  color: #a855f7

                &.cyan
                  background-color: rgba(6, 182, 212, 0.2)
                  color: #06b6d4

                &.gray
                  background-color: colors.$gray
                  color: colors.$subtext

          &.actor
            .actor-info
              display: flex
              flex-direction: column
              gap: 0.25rem
              min-width: 0

              .actor-name
                color: colors.$white
                font-weight: 500
                white-space: nowrap
                overflow: hidden
                text-overflow: ellipsis

              .actor-ip
                color: colors.$subtext
                font-size: 0.8rem
                font-family: monospace
                white-space: nowrap

          &.resource
            .resource-badge
              padding: 0.25rem 0.625rem
              background-color: colors.$dark-gray
              color: colors.$white
              border-radius: 0.5rem
              font-size: 0.75rem
              border: 1px solid colors.$gray
              white-space: nowrap
              overflow: hidden
              text-overflow: ellipsis

              @media (max-width: $mobile)
                font-size: 0.7rem
                padding: 0.2rem 0.5rem

          &.organization
            .org-badge
              padding: 0.25rem 0.625rem
              background-color: rgba(59, 130, 246, 0.2)
              color: #3b82f6
              border-radius: 0.5rem
              font-size: 0.75rem
              white-space: nowrap

              @media (max-width: $mobile)
                font-size: 0.7rem
                padding: 0.2rem 0.5rem

            .personal-badge
              padding: 0.25rem 0.625rem
              background-color: colors.$dark-gray
              color: colors.$subtext
              border-radius: 0.5rem
              font-size: 0.75rem
              border: 1px solid colors.$gray
              white-space: nowrap

              @media (max-width: $mobile)
                font-size: 0.7rem
                padding: 0.2rem 0.5rem

          &.details
            justify-content: flex-end
            gap: 0.5rem

            @media (max-width: $mobile)
              display: none !important

            .play-recording-btn
              display: flex
              align-items: center
              justify-content: center
              padding: 0.375rem
              background: colors.$success-opacity
              border: none
              border-radius: 0.375rem
              cursor: pointer
              transition: all 0.15s ease

              svg
                color: colors.$success

              &:hover
                transform: scale(1.05)

            .expand-icon
              width: 1.125rem
              height: 1.125rem
              color: colors.$subtext
              opacity: 0.9
              transition: transform 0.12s cubic-bezier(0.4, 0, 0.2, 1), color 0.1s ease

              &.expanded
                transform: rotate(90deg)
                color: colors.$primary
                opacity: 1

      .row-expanded
        background-color: colors.$dark-gray
        border-top: 1px solid colors.$dark-gray
        border-radius: 0 0 0.5rem 0.5rem
        margin-top: 0.25rem

        .expanded-content
          padding: 0.75rem
          display: flex
          flex-direction: column
          gap: 0.75rem

          @media (max-width: $mobile)
            padding: 0.625rem
            gap: 0.5rem

          .reason-section,
          .user-agent-section,
          .details-section
            h4
              margin: 0 0 0.5rem 0
              font-size: 0.8rem
              color: colors.$subtext
              font-weight: 500

              @media (max-width: $mobile)
                font-size: 0.75rem
                margin-bottom: 0.375rem

            p
              margin: 0
              color: colors.$white
              line-height: 1.4
              font-size: 0.9rem
              word-break: break-word

              @media (max-width: $mobile)
                font-size: 0.85rem

              svg
                width: 1.125rem
                height: 1.125rem
                margin-right: 0.5rem
                vertical-align: middle
                opacity: 0.9

          .audit-details
            display: grid
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr))
            gap: 0.75rem

            @media (max-width: $tablet)
              grid-template-columns: repeat(auto-fit, minmax(150px, 1fr))
              gap: 0.625rem

            @media (max-width: $mobile)
              grid-template-columns: 1fr
              gap: 0.5rem

            .detail-item
              display: flex
              flex-direction: column
              gap: 0.25rem
              padding: 0.5rem
              background-color: colors.$darker-gray
              border-radius: 0.4rem
              border: 1px solid colors.$gray

              .detail-key
                font-size: 0.75rem
                color: colors.$subtext
                text-transform: capitalize

              .detail-value
                color: colors.$white
                font-family: monospace
                font-size: 0.85rem
                word-break: break-word

                @media (max-width: $mobile)
                  font-size: 0.8rem

.pagination
  display: flex
  align-items: center
  justify-content: space-between
  padding: 0.625rem 0.75rem
  border-top: 1px solid colors.$dark-gray
  background-color: colors.$dark-gray
  border-radius: 0 0 0.5rem 0.5rem
  flex-shrink: 0

  @media (max-width: $mobile)
    padding: 0.375rem 0.5rem

  .pagination-info
    color: colors.$subtext
    font-size: 0.85rem

    @media (max-width: $mobile)
      display: none

  .pagination-controls
    display: flex
    align-items: center
    gap: 0.75rem

    @media (max-width: $mobile)
      width: 100%
      justify-content: center
      gap: 0.5rem

    .page-info
      color: colors.$white
      font-weight: 500
      font-size: 0.9rem
      white-space: nowrap

      @media (max-width: $mobile)
        font-size: 0.8rem

    button
      @media (max-width: $mobile)
        padding: 0.35rem 0.625rem
        font-size: 0.8rem
